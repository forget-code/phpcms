<?php
defined('IN_PHPCMS') or exit('Access Denied');

$module = 'movie';
if(!is_dir(PHPCMS_ROOT.'/'.$module.'/'))
{
	dir_copy(PHPCMS_ROOT.'/module/'.$module.'/copy/', PHPCMS_ROOT.'/'.$module.'/');
}
elseif(!is_writable(PHPCMS_ROOT.'/'.$module.'/config.inc.php'))
{
	showmessage('Please chmod 0777 ./'.$module.'/config.inc.php !');
}

$sql = '';
if($db->version() > '4.1' && $CONFIG['dbcharset'])
{
	$sql = " DEFAULT CHARSET=".$CONFIG['dbcharset'];
}

$db->query("INSERT INTO `".$CONFIG['tablepre']."module` (`name`, `module`, `moduledir`, `moduledomain`, `iscore`, `iscopy`, `isshare`, `version`, `author`, `site`, `email`, `introduce`, `license`, `faq`, `setting`, `disabled`, `publishdate`, `installdate`, `updatedate`) VALUES ('影视', 'movie', 'movie', '', 0, 1, 0, '1.0.0', 'phpcms团队', 'www.phpcms.cn', 'phpcms@163.com', '影视娱乐', '', '', 'a:22:{s:11:\"choose_mode\";s:1:\"0\";s:8:\"playerid\";s:1:\"2\";s:8:\"serverid\";s:1:\"0\";s:4:\"hits\";s:3:\"123\";s:9:\"extension\";s:2:\"rm\";s:10:\"onlineview\";s:1:\"1\";s:13:\"serialization\";s:1:\"1\";s:13:\"keywords_show\";s:1:\"1\";s:12:\"keywords_add\";s:1:\"1\";s:11:\"editor_mode\";s:6:\"editor\";s:12:\"editor_width\";s:4:\"100%\";s:13:\"editor_height\";s:3:\"200\";s:14:\"bigthumb_width\";s:3:\"470\";s:15:\"bigthumb_height\";s:3:\"200\";s:11:\"thumb_width\";s:3:\"120\";s:12:\"thumb_height\";s:3:\"148\";s:16:\"enable_guest_add\";s:1:\"0\";s:10:\"check_code\";s:1:\"1\";s:9:\"add_point\";s:1:\"2\";s:9:\"del_point\";s:1:\"0\";s:6:\"expire\";s:2:\"10\";s:18:\"enable_virtualwall\";s:1:\"0\";}', 0, '0000-00-00', '0000-00-00', '0000-00-00')");


$db->query("INSERT INTO `".$CONFIG['tablepre']."channel` (`module`, `channelname`, `style`, `channelpic`, `introduce`, `seo_title`, `seo_keywords`, `seo_description`, `listorder`, `islink`, `channeldir`, `channeldomain`, `disabled`, `templateid`, `skinid`, `items`, `comments`, `categorys`, `specials`, `hits`, `enablepurview`, `arrgroupid_browse`, `purview_message`, `point_message`, `enablecontribute`, `enablecheck`, `emailofreject`, `emailofpassed`, `enableupload`, `uploaddir`, `maxfilesize`, `uploadfiletype`, `linkurl`, `setting`, `ishtml`, `cat_html_urlruleid`, `item_html_urlruleid`, `special_html_urlruleid`, `cat_php_urlruleid`, `item_php_urlruleid`, `special_php_urlruleid`) VALUES ('movie', '影视', '', '', '', '', '', '', 4, 0, 'movie', '', 0, '0', '', 146, 0, 0, 0, 0, 0, '', '<div align=''center'' style=''color:red''>对不起，您没有阅读权限！</div>\r\n<a href=\"javascript:window.close()\" class=\"close_icon\">关闭窗口</a>', '<p align=''center''><span style=''background:#E3E3E3''><a href=''\{\$readurl\}'' class=''read''>此影片需要消耗<font color=''red''>\{\$readpoint\}</font>点，您确认点播吗？</a></span></p><br/>', 1, 1, '退稿时站内短信/Email通知内容：\r\n', '稿件被采用时站内短信/Email通知内容：\r\n', 1, 'uploadfile', 1024000, 'gif|jpg|bmp|png|doc|rar|zip|txt|rmvb', 'movie/', '', 0, 0, 0, 0, 0, 0, 0)");
$channelid = $db->insert_id();

$db->query("DROP TABLE IF EXISTS `".$CONFIG['tablepre']."movie_".$channelid."`");
$db->query("CREATE TABLE `".$CONFIG['tablepre']."movie_".$channelid."` (
  `movieid` int(10) unsigned NOT NULL auto_increment,
  `catid` smallint(5) unsigned NOT NULL default '0',
  `specialid` smallint(5) unsigned NOT NULL default '0',
  `typeid` smallint(5) unsigned NOT NULL default '0',
  `letter` varchar(1) NOT NULL,
  `title` varchar(100) NOT NULL default '',
  `style` varchar(50) NOT NULL default '',
  `introduce` mediumtext NOT NULL,
  `keywords` varchar(100) NOT NULL default '',
  `onlineview` tinyint(1) unsigned NOT NULL,
  `allowdown` tinyint(1) unsigned NOT NULL,
  `serverid` smallint(5) unsigned NOT NULL default '0',
  `playerid` smallint(5) unsigned NOT NULL,
  `autoselect` tinyint(1) unsigned NOT NULL,
  `movieurls` mediumtext NOT NULL,
  `hits` int(10) unsigned NOT NULL default '0',
  `comments` int(10) unsigned NOT NULL default '0',
  `totalview` int(10) unsigned NOT NULL default '0',
  `todayview` int(10) unsigned NOT NULL default '0',
  `weekview` int(10) unsigned NOT NULL default '0',
  `monthview` int(10) unsigned NOT NULL default '0',
  `bigthumb` varchar(255) NOT NULL,
  `thumb` varchar(255) NOT NULL default '',
  `username` varchar(20) NOT NULL default '',
  `addtime` int(10) unsigned NOT NULL default '0',
  `editor` varchar(25) NOT NULL default '',
  `edittime` int(10) unsigned NOT NULL default '0',
  `checker` varchar(25) NOT NULL default '',
  `checktime` int(10) unsigned NOT NULL default '0',
  `templateid` varchar(20) NOT NULL default '0',
  `skinid` varchar(20) NOT NULL default '0',
  `stars` tinyint(1) NOT NULL default '0',
  `serialization` tinyint(1) unsigned NOT NULL default '0',
  `arrposid` varchar(50) NOT NULL default '',
  `status` tinyint(1) NOT NULL default '0',
  `listorder` smallint(4) unsigned NOT NULL default '0',
  `arrgroupidview` varchar(255) NOT NULL default '',
  `readpoint` smallint(5) unsigned NOT NULL default '0',
  `ishtml` tinyint(1) unsigned NOT NULL default '1',
  `htmldir` varchar(20) NOT NULL default '',
  `prefix` varchar(50) NOT NULL default '',
  `urlruleid` tinyint(3) unsigned NOT NULL default '0',
  `islink` tinyint(1) unsigned NOT NULL default '0',
  `linkurl` varchar(255) NOT NULL default '',
  `lastviewtime` int(10) NOT NULL,
  `my_actor` varchar(255) NOT NULL,
  PRIMARY KEY  (`movieid`),
  KEY `typeid` (`typeid`,`catid`,`status`,`listorder`,`movieid`),
  KEY `username` (`username`(10)),
  KEY `catid` (`catid`,`listorder`,`status`,`movieid`),
  KEY `hits` (`hits`,`movieid`,`status`), 
  FULLTEXT KEY `keywords` (`keywords`)
) TYPE=MyISAM".$sql);


$db->query("DROP TABLE IF EXISTS `".$CONFIG['tablepre']."movie_server`");
$db->query("CREATE TABLE `".$CONFIG['tablepre']."movie_server` (
  `serverid` smallint(5) unsigned NOT NULL auto_increment,
  `onlineurl` varchar(255) NOT NULL,
  `downurl` varchar(255) NOT NULL,
  `isapi` varchar(255) NOT NULL,
  `servername` varchar(100) NOT NULL,
  `maxnum` int(10) unsigned NOT NULL,
  `num` int(10) unsigned NOT NULL,
  PRIMARY KEY  (`serverid`)
) TYPE=MyISAM".$sql);

$db->query("DROP TABLE IF EXISTS `".$CONFIG['tablepre']."movie_player`");
$db->query("CREATE TABLE `".$CONFIG['tablepre']."movie_player` (
  `playerid` int(5) unsigned NOT NULL auto_increment,
  `subject` varchar(100) NOT NULL,
  `code` text NOT NULL,
  `disabled` tinyint(1) unsigned NOT NULL default '1',
  `iscore` tinyint(1) unsigned NOT NULL default '0',
  PRIMARY KEY  (`playerid`)
) TYPE=MyISAM".$sql);
$db->query("INSERT INTO `".$CONFIG['tablepre']."movie_player` (`playerid`, `subject`, `code`, `disabled`, `iscore`) VALUES 
(1, 'RealPlayer', '<script language=\"javascript\">\r\nvar ERR_FileNotFind=\"播放器提示：未找到点播文件！请报告影片错误给管理员\";\r\nvar ERR_NotLocateServer=\"播放器提示：无法连接服务器或连接服务器超时！\";\r\nvar ERR_UnkownError=\"播放器提示：发生了未知错误！\";\r\n</script>\r\n<script LANGUAGE=\"VBScript\">                                    \r\non error resume next \r\nSub player_OnBuffering(lFlags,lPercentage)\r\nif (lPercentage=100) then\r\nStartPlay=false\r\nif (FirstPlay) then\r\nFirstPlay=false\r\nend if\r\nexit sub\r\nend if\r\nEnd Sub\r\nSub player_OnErrorMessage(uSeverity, uRMACode, uUserCode, pUserString, pMoreInfoURL, pErrorString)\r\nselect case player.GetLastErrorRMACode()\r\n   case -2147221496\r\nwindow.alert(ERR_FileNotFind)\r\n   case -2147221433,-2147221428,-2147221417,-2147217468\r\nwindow.alert(ERR_NotLocateServer)\r\ncase -2147221436\r\nwindow.alert(\"系统提示！播放器无法连接到点播文件服务器\")\r\n   case else\r\nwindow.alert(ERR_UnkownError)\r\nend select\r\nEnd Sub\r\n</script>\r\n<center>\r\n<TABLE cellPadding=0 cellSpacing=0 border=1 height=\"100%\" width=\"100%\" id=\"table2\">\r\n<TR>\r\n<TD>\r\n<OBJECT classid=\"clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA\" height=\"100%\" id=RP1 name=RP1 width=\"100%\">\r\n<PARAM NAME=\"AUTOSTART\" VALUE=\"-1\">\r\n<PARAM NAME=\"SHUFFLE\" VALUE=\"0\">\r\n<PARAM NAME=\"PREFETCH\" VALUE=\"0\">\r\n<PARAM NAME=\"NOLABELS\" VALUE=\"0\">\r\n<PARAM NAME=\"CONTROLS\" VALUE=\"Imagewindow\">\r\n<PARAM NAME=\"CONSOLE\" VALUE=\"clip1\">\r\n<PARAM NAME=\"LOOP\" VALUE=\"0\">\r\n<PARAM NAME=\"NUMLOOP\" VALUE=\"0\">\r\n<PARAM NAME=\"CENTER\" VALUE=\"0\">\r\n<PARAM NAME=\"MAINTAINASPECT\" VALUE=\"1\">\r\n<PARAM NAME=\"BACKGROUNDCOLOR\" VALUE=\"#000000\">\r\n</OBJECT>\r\n</TD></TR><TR><TD height=60>\r\n<TABLE align=center border=0 cellPadding=0 cellSpacing=0 width=\"100%\" id=\"table3\">\r\n<TR><TD align=middle bgColor=#000000>\r\n<TABLE border=1 cellPadding=0 cellSpacing=0 width=\"100%\" id=\"table4\">\r\n<TR><TD width=50>\r\n<IMG border=0 height=30 onclick=document.RP1.SetFullScreen() src=\"\{\$PHPCMS[siteurl]}images/player/full.gif\" width=50></TD>\r\n<TD>\r\n<OBJECT classid=clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA  height=30 id=player name=player width=\"100%\">\r\n<PARAM NAME=\"_ExtentX\" VALUE=\"4657\">\r\n<PARAM NAME=\"_ExtentY\" VALUE=\"794\">\r\n<PARAM NAME=\"AUTOSTART\" VALUE=\"-1\">\r\n<PARAM NAME=\"SRC\" VALUE=\"{\$filepath}\">\r\n<PARAM NAME=\"SHUFFLE\" VALUE=\"0\">\r\n<PARAM NAME=\"PREFETCH\" VALUE=\"0\">\r\n<PARAM NAME=\"NOLABELS\" VALUE=\"-1\">\r\n<PARAM NAME=\"CONTROLS\" VALUE=\"ControlPanel\">\r\n<PARAM NAME=\"CONSOLE\" VALUE=\"clip1\">\r\n<PARAM NAME=\"LOOP\" VALUE=\"0\">\r\n<PARAM NAME=\"NUMLOOP\" VALUE=\"0\">\r\n<PARAM NAME=\"CENTER\" VALUE=\"0\">\r\n<PARAM NAME=\"MAINTAINASPECT\" VALUE=\"1\">\r\n<PARAM NAME=\"BACKGROUNDCOLOR\" VALUE=\"#000000\">\r\n</OBJECT>\r\n</TD></TR></TABLE></TD></TR>\r\n<TR>\r\n<TD align=middle bgColor=#000000>\r\n<OBJECT classid=clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA height=30 id=RP3 name=RP3 width=\"100%\">\r\n<PARAM NAME=\"_ExtentX\" VALUE=\"4657\">\r\n<PARAM NAME=\"_ExtentY\" VALUE=\"794\">\r\n<PARAM NAME=\"AUTOSTART\" VALUE=\"-1\">\r\n<PARAM NAME=\"SHUFFLE\" VALUE=\"0\">\r\n<PARAM NAME=\"PREFETCH\" VALUE=\"0\">\r\n<PARAM NAME=\"NOLABELS\" VALUE=\"-1\">\r\n<PARAM NAME=\"CONTROLS\" VALUE=\"StatusBar\">\r\n<PARAM NAME=\"CONSOLE\" VALUE=\"clip1\">\r\n<PARAM NAME=\"LOOP\" VALUE=\"0\">\r\n<PARAM NAME=\"NUMLOOP\" VALUE=\"0\">\r\n<PARAM NAME=\"CENTER\" VALUE=\"0\">\r\n<PARAM NAME=\"MAINTAINASPECT\" VALUE=\"1\">\r\n<PARAM NAME=\"BACKGROUNDCOLOR\" VALUE=\"#000000\">\r\n</OBJECT>\r\n</TD></TR></TABLE></TD></TR></TABLE>', 1, 1),
(2, 'window media player', '<object classid=\"clsid:22D6F312-B0F6-11D0-94AB-0080C74C7E95\" id=\"MediaPlayer1\" width=\"100%\" height=\"100%\">\r\n<param name=\"AudioStream\" value=\"-1\">\r\n<param name=\"AutoSize\" value=\"-1\">\r\n<!--是否自动调整播放大小-->\r\n<param name=\"AutoStart\" value=\"-1\">\r\n<!--是否自动播放-->\r\n<param name=\"AnimationAtStart\" value=\"-1\">\r\n<param name=\"AllowScan\" value=\"-1\">\r\n<param name=\"AllowChangeDisplaySize\" value=\"-1\">\r\n<param name=\"AutoRewind\" value=\"0\">\r\n<param name=\"Balance\" value=\"0\">\r\n<!--左右声道平衡,最左-9640,最右9640-->\r\n<param name=\"BaseURL\" value>\r\n<param name=\"BufferingTime\" value=\"15\">\r\n<!--缓冲时间-->\r\n<param name=\"CaptioningID\" value>\r\n<param name=\"ClickToPlay\" value=\"-1\">\r\n<param name=\"CursorType\" value=\"0\">\r\n<param name=\"CurrentPosition\" value=\"0\">\r\n<!--当前播放进度 -1 表示不变,0表示开头 单位是秒,比如10表示从第10秒处开始播放,值必须是-1.0或大于等于0-->\r\n<param name=\"CurrentMarker\" value=\"0\">\r\n<param name=\"DefaultFrame\" value>\r\n<param name=\"DisplayBackColor\" value=\"0\">\r\n<param name=\"DisplayForeColor\" value=\"16777215\">\r\n<param name=\"DisplayMode\" value=\"0\">\r\n<param name=\"DisplaySize\" value=\"0\">\r\n<!--视频1-50%, 0-100%, 2-200%,3-全屏 其它的值作0处理,小数则采用四舍五入然后按前的处理-->\r\n<param name=\"Enabled\" value=\"-1\">\r\n<param name=\"EnableContextMenu\" value=\"-1\">\r\n<!-是否用右键弹出菜单控制-->\r\n<param name=\"EnablePositionControls\" value=\"-1\">\r\n<param name=\"EnableFullScreenControls\" value=\"-1\">\r\n<param name=\"EnableTracker\" value=\"-1\">\r\n<!--是否允许拉动播放进度条到任意地方播放-->\r\n<param name=\"Filename\" value=\"{\$filepath}\" valuetype=\"ref\">\r\n<!--播放的文件地址-->\r\n<param name=\"InvokeURLs\" value=\"-1\">\r\n<param name=\"Language\" value=\"-1\">\r\n<param name=\"Mute\" value=\"0\">\r\n<!--是否静音-->\r\n<param name=\"PlayCount\" value=\"1\">\r\n<!--重复播放次数,0为始终重复-->\r\n<param name=\"PreviewMode\" value=\"-1\">\r\n<param name=\"Rate\" value=\"1\">\r\n<!--播放速率控制,1为正常,允许小数-->\r\n<param name=\"SAMIStyle\" value=\"1\">\r\n<!--SAMI样式-->\r\n<param name=\"SAMILang\" value>\r\n<!--SAMI语言-->\r\n<param name=\"SAMIFilename\" value>\r\n<!--字幕ID-->\r\n<param name=\"SelectionStart\" value=\"-1\">\r\n<param name=\"SelectionEnd\" value=\"-1\">\r\n<param name=\"SendOpenStateChangeEvents\" value=\"-1\">\r\n<param name=\"SendWarningEvents\" value=\"-1\">\r\n<param name=\"SendErrorEvents\" value=\"-1\">\r\n<param name=\"SendKeyboardEvents\" value=\"0\">\r\n<param name=\"SendMouseClickEvents\" value=\"0\">\r\n<param name=\"SendMousemovieeEvents\" value=\"0\">\r\n<param name=\"SendPlayStateChangeEvents\" value=\"-1\">\r\n<param name=\"ShowCaptioning\" value=\"0\">\r\n<!--是否显示字幕,为一块黑色,下面会有一大块黑色,一般不显示-->\r\n<param name=\"ShowControls\" value=\"-1\">\r\n<!--是否显示控制,比如播放,停止,暂停-->\r\n<param name=\"ShowAudioControls\" value=\"-1\">\r\n<!--是否显示音量控制-->\r\n<param name=\"ShowDisplay\" value=\"0\">\r\n<!--显示节目信息,比如版权等-->\r\n<param name=\"ShowGotoBar\" value=\"0\">\r\n<!--是否启用上下文菜单-->\r\n<param name=\"ShowPositionControls\" value=\"-1\">\r\n<!--是否显示往前往后及列表,如果显示一般也都是灰色不可控制-->\r\n<param name=\"ShowStatusBar\" value=\"-1\">\r\n<!--当前播放信息,显示是否正在播放,及总播放时间和当前播放到的时间-->\r\n<param name=\"ShowTracker\" value=\"-1\">\r\n<!--是否显示当前播放跟踪条,即当前的播放进度条-->\r\n<param name=\"TransparentAtStart\" value=\"-1\">\r\n<param name=\"VideoBorderWidth\" value=\"0\">\r\n<!--显示部的宽部,如果小于视频宽,则最小为视频宽,或者加大到指定值,并自动加大高度.此改变只改变四周的黑框大小,不改变视频大小-->\r\n<param name=\"VideoBorderColor\" value=\"0\">\r\n<!--显示黑色框的颜色, 为RGB值,比如ffff00为黄色-->\r\n<param name=\"VideoBorder3D\" value=\"0\">\r\n<param name=\"Volume\" value=\"0\">\r\n<!--音量大小,负值表示是当前音量的减值,值自动会取绝对值,最大为0,最小为-9640-->\r\n<param name=\"WindowlessVideo\" value=\"0\">\r\n<!--如果是0可以允许全屏,否则只能在窗口中查看-->\r\n</object>', 1, 1),
(3, '精美real播放器', '<Script Language=\"JavaScript\">\r\nIEvar=navigator.appVersion.substring(navigator.appVersion.indexOf(''MSIE'')+5,navigator.appVersion.indexOf('';'',17));\r\nif(IEvar==\"6.0\")\r\n{\r\n  ie6 = true;\r\n  width_add = 10;\r\n  height_add = 29;\r\n  jjjj = 5;\r\n  hand_add = -14;\r\n}\r\nelse\r\n{\r\n  ie6 = false;\r\n  width_add = 0;\r\n  height_add = 0;\r\n  jjjj = 0;\r\n  hand_add = 0;\r\n}\r\nb_width = 0;\r\nb_height = 0;\r\n\r\n//屏蔽右键\r\n   function no_newwin(){\r\n   if((event.ctrlKey)&&(event.keyCode==78)){\r\n   event.keyCode=0;\r\n   event.returnValue=false;\r\n   }\r\n}\r\n\r\nfunction click()\r\n{\r\n   return false;\r\n}\r\ndocument.oncontextmenu=click;\r\ndocument.onmousemoviee=click;\r\n\r\ndocument.ondragstart=doDragStart\r\nfunction doDragStart() {event.returnValue=false}\r\n\r\n\r\n//-------------------------\r\n\r\nvar Real;\r\nReal=''rPlayer.'';\r\nvar Mute=false;\r\nvar CanSetPos=true;\r\nvar SetPosStart=false;\r\nvar SetVolStart=false;\r\nvar loop, timer, initialised;\r\nvar speed=50;\r\nvar oldwidth=566,oldheight=502;\r\nmovieeon=false;movieelen=300;rm_tollen=0;timelen=0;volumlen=56;iScrollLength=140;\r\n\r\ndocument.onmouseup=Total_Up;\r\n\r\nfunction Total_Up(){\r\nif(event.button!=2){\r\nif(SetPosStart){\r\nsetpos();\r\nballmoviee();\r\n}\r\nif(SetVolStart) setvol();\r\n }\r\n}\r\n\r\nfunction moviees()\r\n{\r\nif(CanSetPos&&event.button!=2)\r\n{\r\norix=event.x;\r\norileft=mblock.style.pixelLeft;\r\nif(movieeon)\r\n{\r\nclearTimeout(balltime);\r\n}\r\nSetPosStart=true;\r\n}\r\nelse\r\n  return false;\r\n}\r\n\r\nfunction ChangePos() {\r\nnewleft=event.x;\r\n{\r\nSetPosStart=false;\r\nif (event.x < movieelen+10)\r\n  newleft=event.x-10;\r\nelse\r\n  newleft=movieelen-1;\r\nif (event.x < 10)\r\n  newleft=0;\r\nrm_tollen = GetLength();\r\nrcp=Math.round((newleft/movieelen)*rm_tollen);\r\nSetPosition(rcp);\r\nmblock.style.left = newleft;\r\nplay()\r\n}\r\n}\r\n\r\nfunction movieego()\r\n{\r\nif(SetPosStart)\r\n{\r\nnewx=event.x;\r\ndisx=newx-orix;\r\nnewleft=orileft+disx;\r\nif(newleft>-1&&newleft<movieelen) mblock.style.left=newleft;\r\n}\r\n}\r\n\r\nfunction setpos()\r\n{\r\nSetPosStart=false;\r\nnewleft=mblock.style.pixelLeft;\r\nrm_tollen = GetLength();\r\nrcp=Math.round((newleft/movieelen)*rm_tollen);\r\nSetPosition(rcp);\r\n}\r\n\r\nfunction vols()\r\n{\r\nif(event.button!=2)\r\n{\r\norix=event.x;\r\norileft=vblock.style.pixelLeft;\r\nSetVolStart=true;\r\n}\r\n}\r\n\r\nfunction volgo()\r\n{\r\nif(SetVolStart)\r\n{\r\nnewx=event.x;\r\ndisx=newx-orix;\r\nnewleft=orileft+disx;\r\nif(newleft>5&&newleft<=volumlen) vblock.style.left=newleft;\r\n}\r\n}\r\n\r\nfunction setvol()\r\n{//设置音量\r\nSetVolStart=false;\r\nnewleft=vblock.style.pixelLeft;\r\nnewvol=-(Math.round((volumlen-newleft)*2000/(volumlen-6)));\r\nSetVolume(newvol);\r\n}\r\nfunction RealincreaseVolume(){\r\nif(window.rPlayer!=null)\r\n{\r\nif(volumlen >= 100 )\r\nvolumlen = 100;\r\nelse\r\nvolumlen += 10;\r\nrPlayer.SetVolume(volumlen);\r\n}}\r\nfunction RealdecreseVolume()\r\n{\r\n   if(window.rPlayer!=null)\r\n{\r\nif(volumlen <= 0 )\r\nvolumlen = 0;\r\nelse\r\nvolumlen -= 10;\r\nrPlayer.SetVolume(volumlen);\r\n}}\r\n  \r\n//-------------------------\r\n\r\nfunction ballmoviee()\r\n{//移动进度条\r\nmovieelen = movie.style.pixelWidth-20;\r\naa = rPlayer.GetPosition();\r\ndd = rPlayer.Getlength();\r\nif (rPlayer.FILENAME!=\"\" && isFinite(Math.round(aa/dd*movieelen)))\r\n{\r\n  mblock.style.left = Math.round(aa/dd*movieelen);\r\n}\r\nballtime = setTimeout(''ballmoviee();'',1000);\r\n}\r\n\r\nfunction SetPosition(Pos)\r\n{\r\neval(Real+''SetPosition(Pos)'');\r\n}\r\nfunction SetVolume(Pos)\r\n{\r\neval(Real+''Volume=Pos'');\r\n}\r\nfunction SetFastForward()\r\n{\r\nif (rPlayer.CanScan)\r\neval(Real+''FastForward()'');\r\n}\r\nfunction SetFastReverse()\r\n{\r\nif (rPlayer.CanScan)\r\neval(Real+''FastReverse()'');\r\n}\r\nfunction GetLength()\r\n{\r\nreturn eval(Real+''GetLength()'');\r\n}\r\nfunction GetPosition()\r\n{\r\ntt=eval(Real+''GetPosition()'');\r\nreturn tt*1000;\r\n}\r\nfunction SetMute(Status)\r\n{\r\nif (Status)\r\n{\r\neval(Real+''Mute=true'');\r\n}\r\nelse\r\neval(Real+''Mute=false'');\r\neval(Real+''Play()'');\r\n}\r\nfunction FastpositionSet() {\r\n  if(window.rPlayer!=null)\r\n  {\r\n var iLength=rPlayer.GetLength();\r\n var iPosition=rPlayer.GetPosition();\r\n var FastPosition=iLength/20;\r\n if ((iPosition+FastPosition)<=iLength) \r\n {\r\n   iPosition=iPosition+FastPosition;\r\n   rPlayer.SetPosition(iPosition);\r\n }\r\n  }  \r\n  }  \r\nfunction BackpositionSet() {\r\nif(window.rPlayer!=null)\r\n  {\r\n var iLength=rPlayer.GetLength();\r\n var iPosition=rPlayer.GetPosition();\r\n var BackPosition=iLength/20;\r\n if (iPosition>=BackPosition) \r\n {\r\n   iPosition=iPosition-BackPosition;\r\n   rPlayer.SetPosition(iPosition);\r\n }\r\n  }\r\n}\r\nfunction ClickSound(aa)\r\n{\r\nif (Mute)\r\n{\r\nMute=false;\r\nSetMute(Mute);\r\naa.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_08_over.gif'';\r\n}\r\nelse\r\n{\r\nMute=true;\r\nSetMute(Mute);\r\naa.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_08_down.gif'';\r\n}\r\n}\r\n\r\n\r\n//------------------------\r\n\r\nvar PauseStatus = 0;\r\nvar Fill = false;\r\nvar Playing=true;\r\nfunction Playorpasue()\r\n{\r\nif (Playing)\r\n{\r\npause();\r\n}\r\nelse\r\n{\r\nplay();\r\n}\r\n}\r\n\r\nfunction Stop() {\r\n\r\n{\r\nrPlayer.DoStop();\r\nif (Playing)\r\n{\r\nPlaying = false;\r\npp001.src = \"{\$PHPCMS[siteurl]}images/mediaplayer/toole_03.gif\";\r\npp001.onmouseover=new Function(\"this.src = ''{\$PHPCMS[siteurl]}images/mediaplayer/toole_03_over.gif''\");\r\npp001.onmouseout=new Function(\"this.src = ''{\$PHPCMS[siteurl]}images/mediaplayer/toole_03.gif''\");\r\n}\r\nif (PauseStatus==0)\r\n{\r\nPauseStatus = 1;\r\n}\r\nmblock.style.left=0;\r\n\r\n}\r\n}\r\n\r\nfunction pause(){\r\npp001.src = \"{\$PHPCMS[siteurl]}images/mediaplayer/toole_03.gif\";\r\npp001.onmouseover=new Function(\"this.src = ''{\$PHPCMS[siteurl]}images/mediaplayer/toole_03_over.gif''\");\r\npp001.onmouseout=new Function(\"this.src = ''{\$PHPCMS[siteurl]}images/mediaplayer/toole_03.gif''\");\r\nPlaying = false;\r\n\r\n{\r\n   \r\n{\r\nif (PauseStatus==0)\r\n{\r\nPauseStatus = 1;\r\n}\r\n rPlayer.DoPause();\r\n}\r\n}\r\n}\r\nfunction play(){\r\npp001.src = \"{\$PHPCMS[siteurl]}images/mediaplayer/toole_04.gif\";\r\npp001.onmouseover=new Function(\"this.src = ''{\$PHPCMS[siteurl]}images/mediaplayer/toole_04_over.gif''\");\r\npp001.onmouseout=new Function(\"this.src = ''{\$PHPCMS[siteurl]}images/mediaplayer/toole_04.gif''\");\r\nPlaying = true;\r\n\r\n{\r\nif (PauseStatus==1)\r\n{\r\nPauseStatus = 0;\r\n}\r\n rPlayer.DoPlay();\r\n}\r\n}\r\n\r\n//-----------------\r\n\r\nfunction DoFill()\r\n{//最大化/还原窗口\r\nif (Fill) \r\n{//还原窗口\r\nwindow.movieeTo((screen.width-b_width)/2,(screen.height-b_height)/2);\r\nwindow.resizeTo(b_width+width_add,b_height+height_add);\r\nfill001.src = \"{\$PHPCMS[siteurl]}images/mediaplayer/Header_06.gif\";\r\nFill = false;\r\nfill001.alt = \"最大化\";\r\n}\r\nelse \r\n{//最大化窗口\r\nwindow.movieeTo(0,0);\r\nb_width = document.body.clientWidth;\r\nb_height = document.body.clientHeight;\r\nwindow.resizeTo(screen.width,screen.height);\r\nfill001.src = \"{\$PHPCMS[siteurl]}images/mediaplayer/Header_08.gif\";\r\nFill = true;\r\nfill001.alt = \"还原\";\r\n}\r\n}\r\n\r\nfunction closewin()\r\n{//关闭窗口\r\n  \r\nrPlayer.DoStop();\r\n  window.close();\r\n}\r\n\r\nfunction DoFull()\r\n{//全屏播放\r\neval(Real+''SetFullScreen()'');\r\n}\r\n\r\nfunction DoMin() \r\n{//最小化窗口\r\noldwidth=window.screenLeft;\r\noldheight=window.screenTop;\r\nwindow.movieeTo(-2000,-2000);\r\nwindow.attachEvent(\"onfocus\",res);\r\n}\r\nfunction res() {\r\nwindow.movieeTo(oldwidth,oldheight);\r\nwindow.detachEvent(\"onfocus\",res)\r\n}\r\n</Script>\r\n\r\n<script language=\"VBScript\">\r\n\r\nsub Mute\r\n   imagesrc=document.all(\"silent\").src\r\n   singlechar=mid(imagesrc,instr(imagesrc,\".gif\")-1,1)\r\n   if singlechar=\"8\" then\r\n   document.all(\"silent\").src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_08_down.gif\"\r\n   document.all(\"silent\").alt=\"恢复\"\r\n   else\r\n   document.all(\"silent\").src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_08.gif\"\r\n   document.all(\"silent\").alt=\"静音\"\r\n   end if\r\n   rPlayer.setMute(not rPlayer.GetMute())\r\nend sub\r\n</script>\r\n\r\n<script for=\"window\" event=\"onresize\" LANGUAGE=\"JavaScript\">\r\n//改变窗口大小了限制\r\nif (toole.style.display==''block'' && ((document.body.clientWidth<440) || (document.body.clientHeight<300+hand_add)))\r\n{\r\n   window.resizeTo(440+width_add,428+height_add+hand_add);\r\n}\r\nif (toole.style.display==''none'' && ((document.body.clientWidth<262) || (document.body.clientHeight<252+hand_add)))\r\n{\r\n   window.resizeTo(262+width_add,252+height_add+hand_add);\r\n}\r\n//Image1.style.height = MP1.style.pixelHeight-24;\r\n</script>\r\n<SCRIPT FOR=\"rPlayer\" EVENT=\"PlayStateChange(lOldState, lNewState)\" LANGUAGE=\"JavaScript\">\r\nif (lNewState==0 || lNewState==8){\r\nPlayorpasue();\r\n}\r\n</SCRIPT>\r\n\r\n<SCRIPT FOR=\"rPlayer\" EVENT=\"OpenStateChange(lOldState, lNewState)\" LANGUAGE=\"JavaScript\">\r\nif (lNewState==0){\r\nPlayorpasue();\r\n}\r\n</SCRIPT>\r\n\r\n<SCRIPT FOR=\"rPlayer\" EVENT=\"Error()\" LANGUAGE=\"JavaScript\">\r\nif (rPlayer.ErrorCode==-1072889837)\r\nPlay_Mess.innerHTML=\"<font color=red size=3>无法连接到服务器，可能是网络问题，请重试。</font>\";\r\nif (rPlayer.ErrorCode==-2147220992)\r\nPlay_Mess.innerHTML=\"<font color=red size=3>没有适当的解码器，请重试或安装新的微软播放器。</font>\";\r\nif (rPlayer.ErrorCode==-2147220945)\r\nPlay_Mess.innerHTML=\"<font color=red size=3>文件格式错，请通知我们，我们将尽快进行维修。</font>\";\r\nif (rPlayer.ErrorCode==-1072889830)\r\nPlay_Mess.innerHTML=\"<font color=red size=3>文件打不开，请通知我们，我们将尽快进行维修。</font>\";\r\nif (rPlayer.ErrorCode==-2146697211)\r\nPlay_Mess.innerHTML=\"<font color=red size=3>无法访问这个服务器，可能是代理服务器不可用。</font>\";\r\nif (rPlayer.ErrorCode==-1072887822)\r\nPlay_Mess.innerHTML=\"<font color=red size=3>无法连接到一个广播频道。</font>\";\r\n</SCRIPT>\r\n\r\n<SCRIPT FOR=\"rPlayer\" EVENT=\"Warning(lType, lParam, sDescription)\" LANGUAGE=\"JScript\">\r\nPlay_Mess.innerHTML=\"<font color=red size=3>\"+sDescription+\"</font>\";\r\n</SCRIPT>\r\n\r\n<SCRIPT LANGUAGE=\"VBScript\">\r\nSub rplayer_OnBuffering(lFlags,lPercentage)\r\n  if (lPercentage=100) then\r\n  StartPlay=false\r\n  if (FirstPlay) then\r\n///Image1.style.visibility = \"visible\"\r\n  else\r\nMP1.style.visibility = \"visible\"\r\n//Image1.style.visibility = \"hidden\"\r\n  end if\r\n  exit sub\r\n  end if\r\nEnd Sub\r\nSub rplayer_OnErrorMessage(uSeverity, uRMACode, uUserCode, pUserString, pMoreInfoURL, pErrorString)\r\nselect case rPlayer.GetLastErrorRMACode()\r\ncase -2147221496\r\n  window.alert(\"您的网络繁忙暂时中断！\")\r\ncase -2147221433,-2147221428,-2147221417,-2147217468\r\n  window.alert(\"您的网络繁忙暂时中断！\")\r\ncase else\r\n  window.alert(\"在线用户过多，服务器限制，请抢线或稍后观看！\")\r\nend select\r\nend sub\r\n</SCRIPT>\r\n\r\n<script language=\"JavaScript\">\r\nvar dragapproved=false;\r\nvar eventsource,x,y;\r\nfunction moviee()\r\n{//移动窗口\r\n  if (event.button==1&&dragapproved) //改变被拖动元素在页面上的位置\r\n  {\r\ntop.window.movieeBy(event.clientX-x, event.clientY-y);\r\nreturn false;\r\n  }\r\n}\r\nfunction size()\r\n{//改变窗口大小\r\n  if (event.button==1&&dragapproved) \r\n  {\r\ntop.window.resizeTo(event.clientX+5+width_add-jjjj, event.clientY+5+height_add-jjjj);\r\nreturn false;\r\n  }\r\n}\r\nfunction drags()\r\n{\r\n  if (event.srcElement.className==\"drag\") //捕捉鼠标和被拖动元素的当前位置\r\n  {\r\ndragapproved=true;\r\nx=event.clientX;\r\ny=event.clientY;\r\ndocument.onmousemoviee=moviee;\r\n  }\r\n  if (event.srcElement.className==\"rs001\") //捕捉鼠标和被拖动元素的当前位置\r\n  {\r\ndragapproved=true;\r\ndocument.onmousemoviee=size;\r\n  }\r\n}\r\n\r\ndocument.onmousedown=drags;   //鼠标左键按下时,准备拖动\r\ndocument.onmouseup=new Function(\"dragapproved=false\");//鼠标左键放开时,拖动停止\r\n\r\nfunction mini(type)\r\n{//精简与正常窗口切换\r\n  if (type==1)\r\n  {\r\ntoole.style.display=''none'';\r\nscroll01.style.display=''none'';\r\nminitoole.style.display=''block'';\r\nwindow.resizeTo(333+width_add,305+height_add+hand_add);\r\n  }\r\n  if (type==0)\r\n  {\r\ntoole.style.display=''block'';\r\nscroll01.style.display=''block'';\r\nminitoole.style.display=''none'';\r\nwindow.resizeTo((440+width_add),428+height_add+hand_add);\r\n  }\r\n}\r\n\r\n//-----------------\r\n\r\n//显示影片进度条时间\r\nfunction scrollPositionMousemoviee(obj, event)\r\n{\r\n  iCurrentX=event.x;\r\n  if(parseInt(iCurrentX)>=movieelen+20)\r\nreturn;\r\n  if(window.MP1!=null)\r\n  {\r\niTotalTime=GetLength();\r\niPlayTime=parseInt(iCurrentX*iTotalTime/(movieelen+20));\r\nHour=parseInt(iPlayTime/(60*60*1000));\r\nMin=parseInt((iPlayTime-Hour*60*60*1000)/(60*1000));\r\nSec=parseInt((iPlayTime-Hour*60*60*1000-Min*60*1000)/1000);\r\nif(String(Hour).length<2)\r\n  strHour=\"0\"+String(Hour);\r\nelse\r\n  strHour=String(Hour);\r\nif(String(Min).length<2)\r\n  strMin=\"0\"+String(Min);\r\nelse\r\n  strMin=String(Min);\r\nif(String(Sec).length<2)\r\n  strSec=\"0\"+String(Sec);\r\nelse\r\n  strSec=+String(Sec);\r\n \r\nif(Hour!=0)\r\nscrollInfo.replaceAdjacentText(\"afterBegin\",strHour+\":\"+strMin+\":\"+strSec);\r\nelse\r\nscrollInfo.replaceAdjacentText(\"afterBegin\",strMin+\":\"+strSec);\r\n\r\nscrollInfo.style.top=event.y+12;\r\nscrollInfo.style.left=event.x+15;\r\nscrollInfo.style.visibility = \"visible\";\r\n  }\r\n}\r\nfunction scrollPositionMouseOut()\r\n{\r\n  scrollInfo.style.visibility = \"hidden\";\r\n}\r\n\r\n//---------------------\r\n\r\nfunction onLond001()\r\n{\r\n  setvol();\r\n  ballmoviee();\r\n}\r\n\r\n</script>\r\n  \r\n</head>\r\n<body bgcolor=\"#000000\" scroll=\"no\" leftmargin=\"0\" topmargin=\"0\" onLoad=\"onLond001();\" onkeydown=\"no_newwin()\">\r\n<center>\r\n<TABLE width=\"100%\" height=\"100%\" BORDER=\"0\" CELLPADDING=\"0\" CELLSPACING=\"0\">\r\n<TR>\r\n<TD colspan=\"3\">\r\n<table id=\"mini_head\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse; display: block;\" bordercolor=\"#111111\" width=\"100%\">\r\n<tr>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/mini_Header_02.gif\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/mini_Header_01.gif\" width=\"4\" height=\"6\"></td>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/mini_Header_02.gif\" align=\"right\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/mini_Header_03.gif\" width=\"3\" height=\"6\"></td>\r\n</tr>\r\n</table>\r\n<table id=\"head\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse; display: none;\" bordercolor=\"#111111\" width=\"100%\">\r\n<tr>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/Header_02.gif\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/Header_01.gif\" width=\"135\" height=\"20\" onmouseover=\"this.style.cursor=''moviee''\" id=\"mydiv1\" class=\"drag\" alt=\"移动窗口\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/Header_03.gif\" width=\"2\" height=\"20\"></td>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/Header_02.gif\"></td>\r\n<td align=\"right\" background=\"{\$PHPCMS[siteurl]}images/mediaplayer/Header_02.gif\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/Header_07.gif\" align=\"absmiddle\" width=\"9\" height=\"9\" alt=\"最小化\" onmousedown=\"DoMin()\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"8\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/Header_06.gif\" align=\"absmiddle\" width=\"9\" height=\"9\" id=\"fill001\" ALT=\"最大化\" onmousedown=\"DoFill()\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"10\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/Header_05.gif\" align=\"absmiddle\" width=\"9\" height=\"9\" ALT=\"关闭窗口\" onmousedown=\"closewin()\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"3\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/Header_04.gif\" align=\"absmiddle\" width=\"5\" height=\"20\" onmouseover=\"this.style.cursor=''hand''\"></td>\r\n</tr>\r\n</table>\r\n<Script language=\"JavaScript\">\r\nif (!ie6)\r\n{\r\nmini_head.style.display = \"none\";\r\nhead.style.display = \"block\";\r\n}\r\n</Script>\r\n</TD>\r\n</TR>\r\n<TR>\r\n<TD background=\"{\$PHPCMS[siteurl]}images/mediaplayer/player_01.gif\"><IMG SRC=\"images/Spacer.gif\" WIDTH=\"7\" HEIGHT=\"1\" id=\"left002\"></TD>\r\n<TD><IMG SRC=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" WIDTH=\"200\" HEIGHT=\"1\" id=\"temp002\"></TD>\r\n<TD background=\"{\$PHPCMS[siteurl]}images/mediaplayer/player_02.gif\" style=\"background-position:right;\"><IMG SRC=\"images/Spacer.gif\" WIDTH=\"6\" HEIGHT=\"1\" id=\"right002\"></TD>\r\n</TR>\r\n<TR>\r\n<TD background=\"{\$PHPCMS[siteurl]}images/mediaplayer/player_01.gif\" width=\"7\" HEIGHT=\"99%\" id=\"left001\"></TD>\r\n<TD width=\"99%\">\r\n<DIV id=\"MP1\" style=\"HEIGHT: 100%; POSITION: relative; TOP: 0px; WIDTH: 100%; Z-INDEX: 1;\">\r\n<object ID=\"rPlayer\" CLASSID=\"clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA\" HEIGHT=\"100%\" WIDTH=\"100%\">\r\n  <param name=\"_ExtentX\" value=\"20055\">\r\n  <param name=\"_ExtentY\" value=\"7064\">\r\n  <param name=\"AUTOSTART\" value=\"-1\">\r\n  <param name=\"SHUFFLE\" value=\"0\">\r\n  <param name=\"PREFETCH\" value=\"0\">\r\n  <param name=\"NOLABELS\" value=\"0\">\r\n  <param name=\"SRC\" value=\"{\$filepath}\">\r\n  <param name=\"CONTROLS\" value=\"ImageWindow\">\r\n  <param name=\"CONSOLE\" value=\"Clip1\">\r\n  <param name=\"LOOP\" value=\"0\">\r\n  <param name=\"NUMLOOP\" value=\"0\">\r\n  <param name=\"CENTER\" value=\"0\">\r\n  <param name=\"MAINTAINASPECT\" value=\"0\">\r\n  <param name=\"BACKGROUNDCOLOR\" value=\"#000000\">\r\n  </object>\r\n</DIV>\r\n<script language=\"javascript\"> \r\nrPlayer.SetEnableContextMenu(false);\r\nrPlayer.SetWantErrors(true);\r\n</script>\r\n</TD>\r\n<TD background=\"{\$PHPCMS[siteurl]}images/mediaplayer/player_02.gif\" style=\"background-position:right;\" width=\"6\" HEIGHT=\"99%\" id=\"right001\"></TD>\r\n</TR>\r\n<tr>\r\n<td colspan=\"3\">\r\n<table id=\"scroll01\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse\" bordercolor=\"#111111\" width=\"100%\">\r\n<tr>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_02.gif\" width=\"3%\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_01.gif\" width=\"3\" height=\"15\"></td>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_02.gif\" width=\"2%\" align=\"right\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_03.gif\" width=\"2\" height=\"15\"></td>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_04.gif\" width=\"70%\">\r\n<DIV onmouseup=\"Total_Up()\" onmousemoviee=\"scrollPositionMousemoviee(this, event)\" onmouseout=\"scrollPositionMouseOut()\" onmousedown=\"ChangePos()\" id=\"movie\" style=\"CURSOR: hand; POSITION: relative; TOP: 1px; LEFT: 0px; WIDTH: 100%; HEIGHT: 8px\"><DIV id=\"mblock\" style=\"LEFT: 0px; POSITION: absolute; TOP: 0px; HEIGHT: 8px\"><IMG alt=\"播放进度\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_07.gif\" width=\"20\" height=\"8\" border=\"0\"></DIV>\r\n<DIV id=\"scrollInfo\" style=\"BORDER: orange 1px ridge; FONT-SIZE: 9px; VISIBILITY: hidden; BACKGROUND: #c0c0c0; POSITION: absolute; zIndex: 9\">00:00</DIV>\r\n</DIV>\r\n</td>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_02.gif\" width=\"10%\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_05.gif\" width=\"2\" height=\"15\"></td>\r\n<td align=\"center\" background=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_02.gif\" width=\"9%\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_08.gif\" width=\"2\" height=\"14\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"1\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_09.gif\" width=\"7\" height=\"15\" alt=\"左声道\" onmousedown=\"rPlayer.Balance=-10000\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"1\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_08.gif\" width=\"2\" height=\"14\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"1\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_10.gif\" width=\"7\" height=\"15\" alt=\"立体声\" onmousedown=\"rPlayer.Balance=0\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"1\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_08.gif\" width=\"2\" height=\"14\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"1\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_11.gif\" width=\"7\" height=\"15\" alt=\"右声道\" onmousedown=\"rPlayer.Balance=10000\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"1\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_08.gif\" width=\"2\" height=\"14\"></td>\r\n<td align=\"right\" background=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_02.gif\" width=\"6%\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/scroll_06.gif\" width=\"4\" height=\"15\"></td>\r\n</tr>\r\n</table>\r\n<table id=\"toole\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"display:block; border-collapse: collapse\" bordercolor=\"#111111\" width=\"100%\" background=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_02.gif\">\r\n<tr>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_02.gif\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_01.gif\" width=\"4\" height=\"49\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"10\" height=\"1\"><img id=\"pp001\" border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_04.gif\" width=\"36\" height=\"49\" ALT=\"播放\" onmousedown=\"Playorpasue()\" onmouseout=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_04.gif''\" onmouseover=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_04_over.gif'';this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_05.gif\" width=\"25\" height=\"49\" ALT=\"停止\" onmousedown=\"Stop()\" onmouseout=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_05.gif''\" onmouseover=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_05_over.gif'';this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"10\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_06.gif\" width=\"25\" height=\"49\" ALT=\"快退\" onmousedown=\"BackpositionSet()\" onmouseout=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_06.gif''\" onmouseover=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_06_over.gif'';this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_07.gif\" width=\"25\" height=\"49\" ALT=\"快进\" onmousedown=\"FastpositionSet()\" onmouseout=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_07.gif''\" onmouseover=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_07_over.gif'';this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"6\" height=\"1\"></td>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_02.gif\" align=\"right\">\r\n<img src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_08.gif\" style=\"cursor:hand;\" alt=\"静音\" name=\"silent\" width=\"26\" height=\"49\" onclick=\"vbscript:Mute\" border=\"0\"></td>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_02.gif\" style=\"background-repeat: no-repeat;\">\r\n<DIV onmouseup=\"Total_Up()\" onmousemoviee=\"volgo()\" id=\"volume\" style=\"LEFT: 0px; WIDTH: 70px; POSITION: relative;HEIGHT: 23px\" valgin=\"top\" align=\"center\"><DIV id=\"vblock\"><IMG src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_16.gif\" width=\"25\" height=\"49\" border=\"0\" ALT=\"减小音量\" onmousedown=\"RealdecreseVolume()\" onmouseout=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_16.gif''\" onmouseover=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_16_over.gif'';this.style.cursor=''hand''\"><IMG src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_17.gif\" width=\"25\" height=\"49\" border=\"0\" ALT=\"增强音量\" onmousedown=\"RealincreaseVolume()\" onmouseout=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_17.gif''\" onmouseover=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_17_over.gif'';this.style.cursor=''hand''\"></DIV>\r\n</DIV>\r\n</td>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_12.gif\" style=\"background-repeat: no-repeat;\">\r\n<MARQUEE id=\"Play_Mess\" WIDTH=\"100\" SCROLLAMOUNT=\"8\" SCROLLDELAY=\"200\" style=\"margin-left: 8; margin-right: 10;\"><FONT color=#284717 size=2>{\$PHPCMS[sitename]}欢迎您观看：{$title}</FONT></MARQUEE>\r\n</td>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_02.gif\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"6\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_09.gif\" width=\"25\" height=\"49\" alt=\"全屏播放\" onmousedown=\"DoFull()\" onmouseout=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_09.gif''\" onmouseover=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_09_over.gif'';this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_10.gif\" width=\"25\" height=\"49\" alt=\"精简模式\" onclick=\"mini(1);\" onmouseout=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_10.gif''\" onmouseover=\"this.src=''{\$PHPCMS[siteurl]}images/mediaplayer/toole_10_over.gif'';this.style.cursor=''hand''\"></td>\r\n<td background=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_02.gif\" align=\"right\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_13.gif\" width=\"13\" height=\"17\" onmouseover=\"this.style.cursor=''se-resize''\" id=\"mydiv100\" class=\"rs001\" alt=\"改变窗口大小\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/toole_14.gif\" width=\"4\" height=\"49\"></td>\r\n</tr>\r\n</table>\r\n<table id=\"minitoole\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse; display:none;\" bordercolor=\"#111111\" width=\"100%\">\r\n<tr>\r\n<td width=\"33%\" background=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_02.gif\">\r\n<img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_01.gif\" width=\"3\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/1pix.gif\" width=\"10\" height=\"1\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_04.gif\" width=\"18\" height=\"20\" ALT=\"播放\" onmousedown=\"play()\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_05.gif\" width=\"18\" height=\"20\" ALT=\"暂停\" onmousedown=\"pause()\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_06.gif\" width=\"18\" height=\"20\" ALT=\"停止\" onmousedown=\"Stop()\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_07.gif\" width=\"18\" height=\"20\" ALT=\"快退\" onmousedown=\"BackpositionSet()\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_08.gif\" width=\"18\" height=\"20\" ALT=\"快进\" onmousedown=\"FastpositionSet()\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_09.gif\" width=\"33\" height=\"20\" alt=\"全屏播放\" onmousedown=\"DoFull()\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_10.gif\" width=\"33\" height=\"20\" alt=\"正常模式\" onclick=\"mini(0);\" onmouseover=\"this.style.cursor=''hand''\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_03.gif\" width=\"6\" height=\"20\"></td>\r\n<td width=\"33%\" background=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_02.gif\">\r\n</td>\r\n<td width=\"34%\" background=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_02.gif\" align=\"right\">\r\n<img class=\"rs001\" border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_12.gif\" width=\"8\" height=\"11\" onmouseover=\"this.style.cursor=''se-resize''\" alt=\"改变窗口大小\"><img border=\"0\" src=\"{\$PHPCMS[siteurl]}images/mediaplayer/miniToole_11.gif\" width=\"3\" height=\"20\"></td>\r\n</tr>\r\n</table>\r\n</td>\r\n</tr>\r\n</TABLE>\r\n', 1, 1),
(4, 'Flv播放器', '<object type=\"application/x-shockwave-flash\" data=\"{\$PHPCMS[siteurl]}images/flvplayer.swf\" width=\"100%\" height=\"100%\">\r\n  <param name=\"movie\" value=\"{\$PHPCMS[siteurl]}images/flvplayer.swf?autostart=true&file={\$filepath}\">\r\n</object>', 1, 1),
(5, 'flash 播放器', '<object width=\"100%\" height=\"100%\"><param name=\"movie\" value=\"{\$filepath}\"></param><param name=\"allowscriptaccess\" value=\"always\"><embed src=\"{\$filepath}\" type=\"application/x-shockwave-flash\" width=\"100%\" height=\"100%\"></embed></object>\r\n', 1, 1),
(6, 'BOBO_p2p', '<EMBED NAME=RealObj SRC=\"test.rpm\" height=86% width=100% CONSOLE=one	CONTROLS=ImageWindow MAINTAINASPECT=true><br>\r\n<object id=WMPObj classid=\"CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6\" height=86% width=100% viewastext=\"\"\r\n	CODEBASE=\"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701\"\r\n	STANDBY=\"Loading Microsoft Windows Media Player components...\" \r\n	TYPE=\"application/x-oleobject\" style=\"display:none\">\r\n<param name=\"URL\" value=\"\">\r\n<PARAM NAME=\"animationatStart\" VALUE=\"true\">\r\n<PARAM NAME=\"autoStart\" VALUE=\"false\">\r\n<PARAM NAME=\"showControls\" VALUE=\"true\">\r\n<param name=\"uiMode\" value=\"None\">\r\n</object>\r\n<Object id=\"BoBo\" width=100% height=22 classid=''clsid:EC0978ED-24E3-403C-AB7A-060E388553E6'' codebase=''http://www.17bobo.com/Software/BoBo_ActiveX_V3.ocx''>\r\n<PARAM NAME=\"MaxLinkCount\"    VALUE=100>\r\n<PARAM NAME=\"MaxCacheTimeS\"   VALUE=120>\r\n<PARAM NAME=\"MinCacheTimeS\"   VALUE=60>\r\n<PARAM NAME=\"MaxCacheSizeMB\"  VALUE=150>\r\n<PARAM NAME=\"MaxDownloadKbps\" VALUE=0>\r\n<PARAM NAME=\"MaxUploadKbps\"   VALUE=0>\r\n<PARAM NAME=\"RealMediaType\"   VALUE=\".mp4,.mp3\">\r\n<PARAM NAME=\"AllowDrag\"      	VALUE=1>\r\n<PARAM NAME=\"BoBoDrag\"      	VALUE=1>\r\n<PARAM NAME=\"ShowSend\"      	VALUE=1>\r\n<PARAM NAME=\"BCServerURL\"     VALUE=\"{\$serverpath}\">\r\n<PARAM NAME=\"TextAd\"       	  VALUE=\"phpcms影视系统全面公测中|http://www.phpcms.cn|#000000||加入PHPCMS推广联盟，开创网络零成本创业|http://www.phpcms.cn|#ff0000\">\r\n<PARAM NAME=\"ActName\" 		    VALUE=\"{\$filepath}\">\r\n</Object>', 1, 1),
(7, '无缓冲播放器', '<table align=\"center\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" height=\"100%\" \r\nborder=\"0\">\r\n  <tr>\r\n    <td align=\"center\" valign=\"middle\">\r\n		<OBJECT ID=\"ActiveX\" name=\"player\" CLASSID=\"CLSID:C3D8F2C7-A508-4724-BC3A-C247058D17EB\" width=\"100%\" height=\"100%\" VIEWASTEXT>\r\n		<param name=\"uimode\" value=\"1\">\r\n		<param name=\"playmode\" value=\"1\">\r\n		<param name=\"autostart\" value=\"0\">\r\n		<param name=\"url\" value=\"{\$filepath}\">\r\n                  <param name=\"keephistory\" value=\"0\">\r\n                  <param name=\"playinplayer\" value=\"0\">\r\n		</OBJECT>\r\n	</td>\r\n   </tr>		\r\n</table>\r\n<SCRIPT language=javascript>\r\n<!--\r\n///\r\nfunction GetPlayerVersion()\r\n{\r\n        try{\r\n          var Player;\r\n          var ret;\r\n          Player = new ActiveXObject(\"VodHelper.NetPlayer\");\r\n          ret = Player.GetCurrentVersion();\r\n          if(ret < 3.77)\r\n          {\r\n                alert(\"网络媒体播放器版本已过期，请重新下载并安装网络媒体播放器!\");\r\n                document.location.href = \"{\$PHPCMS[siteurl]}download/vodplayer.exe\";\r\n                return false;            \r\n          }    \r\n          delete Player;\r\n        }\r\n        catch(e)\r\n        {\r\n            document.player.stop();\r\n            alert(\"请首先下载安装网络媒体播放器!\");\r\n            document.location.href = \"{\$PHPCMS[siteurl]}download/vodplayer.exe\";\r\n            return false;\r\n        }    \r\n    return true;\r\n}\r\nGetPlayerVersion()\r\nfunction pplay()\r\n{\r\n//document.bltplayer.topview=\"1\";\r\ndocument.player.volume=\"100\";\r\ndocument.player.play();\r\n}\r\n//-->\r\nsetTimeout(\"pplay();\", 1000);\r\n</SCRIPT>\r\n', 1, 0);");

$db->query("INSERT INTO `".$CONFIG['tablepre']."field` (`tablename`, `name`, `size`, `title`, `note`, `type`, `defaultvalue`, `options`, `formtype`, `inputtool`, `inputlimit`, `listorder`, `enablehtml`, `enablelist`, `enablesearch`) VALUES ('".$CONFIG['tablepre']."movie_".$channelid."', 'my_actor', 255, '主演', '演员字段', 'varchar', '', '', 'text', '', '', 10, 0, 1, 0)");

$db->query("INSERT INTO `".$CONFIG['tablepre']."menu` (`position`, `name`, `title`, `url`, `target`, `style`, `listorder`, `arrgroupid`, `arrgrade`, `username`) VALUES ('admin_quick_make', '影视首页', '生成影视首页', '?mod=".$current."&file=createhtml&action=index&channelid=".$channelid."', '_self', '', 1, '1', '', '')");
$db->query("INSERT INTO `".$CONFIG['tablepre']."menu` (`position`, `name`, `title`, `url`, `target`, `style`, `listorder`, `arrgroupid`, `arrgrade`, `username`) VALUES ('admin_quick_make', '影视html', '生成影视栏目，内容html页面', '?mod=".$current."&file=createhtml&channelid=".$channelid."', '_self', '', 5, '1', '', '')");
$db->query("INSERT INTO `".$CONFIG['tablepre']."menu` (`position`, `name`, `title`, `url`, `target`, `style`, `listorder`, `arrgroupid`, `arrgrade`, `username`) VALUES ('admin_quick_add', '添加影视', '影视管理首页', '?mod=".$current."&file=".$current."&action=main&channelid=".$channelid."', '_self', '', 0, '1', '', '')");

$config = "<?php\n\$mod = '$module';\n\$channelid = ".$channelid.";\n?>";
file_put_contents(PHPCMS_ROOT.'/'.$module.'/config.inc.php', $config);
@chmod(PHPCMS_ROOT.'/'.$module.'/config.inc.php', 0777);
?>